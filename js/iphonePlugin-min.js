define("SHARED/iphonePlugin",["SHARED/jquery"],function(b){eXo.define.names=["$"];eXo.define.deps=[b];return function(){var h,j=Array.prototype.slice;h=function(){function a(e,d){var c,g,f;this.elem=b(e);g=b.extend({},a.defaults,d);for(c in g)f=g[c],this[c]=f;this.elem.data(this.dataName,this);this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();this.container.css({width:this.containerWidth});this.resizeHandle&&this.optionallyResize("handle");this.initialPosition()}a.prototype.isDisabled=
function(){return this.elem.is(":disabled")};a.prototype.wrapCheckboxWithDivs=function(){this.elem.wrap("<div class='"+this.containerClass+"' />");this.container=this.elem.parent();this.offLabel=b("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=b("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");
return this.handle=b("<div class='"+this.handleClass+"'>\n  <div class='"+this.handleRightClass+"'>\n    <div class='"+this.handleCenterClass+"' />\n  </div>\n</div>").appendTo(this.container)};a.prototype.disableTextSelection=function(){if(b.browser.msie)return b([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on")};a.prototype._getDimension=function(e,a){return null!=b.fn.actual?e.actual(a):e[a]()};a.prototype.optionallyResize=function(a){var d,c;c=this._getDimension(this.onLabel,
"width");d=this._getDimension(this.offLabel,"width");return"container"===a?(a=(c>d?c:d)+(this._getDimension(this.handle,"width")+this.handleMargin),this.container.css({width:a})):this.handle.css({width:c>d?c:d})};a.prototype.onMouseDown=function(e){e.preventDefault();if(!this.isDisabled())return e=e.pageX||e.originalEvent.changedTouches[0].pageX,a.currentlyClicking=this.handle,a.dragStartPosition=e,a.handleLeftOffset=parseInt(this.handle.css("left"),10)||0};a.prototype.onDragMove=function(e,d){var c,
b;if(a.currentlyClicking===this.handle)return b=(d+a.handleLeftOffset-a.dragStartPosition)/this.rightSide,0>b&&(b=0),1<b&&(b=1),c=b*this.rightSide,this.handle.css({left:c}),this.onLabel.css({width:c+this.handleRadius}),this.offSpan.css({marginRight:-c}),this.onSpan.css({marginLeft:-(1-b)*this.rightSide})};a.prototype.onDragEnd=function(e,b){var c;if(!(a.currentlyClicking!==this.handle||this.isDisabled()))return a.dragging?(c=(b-a.dragStartPosition)/this.rightSide,this.elem.prop("checked",0.5<=c)):
this.elem.prop("checked",!this.elem.prop("checked")),a.currentlyClicking=null,a.dragging=null,this.didChange()};a.prototype.refresh=function(){return this.didChange()};a.prototype.didChange=function(){var a;if("function"===typeof this.onChange)this.onChange(this.elem,this.elem.prop("checked"));if(this.isDisabled())return this.container.addClass(this.disabledClass),!1;this.container.removeClass(this.disabledClass);a=this.elem.prop("checked")?this.rightSide:1;this.handle.animate({left:a},this.duration);
this.onLabel.animate({width:a+this.handleRadius+6},this.duration);this.offSpan.animate({marginRight:-a},this.duration);return this.onSpan.animate({marginLeft:a-this.rightSide},this.duration)};a.prototype.attachEvents=function(){var a,d,c;c=this;a=function(a){return c.onGlobalMove.apply(c,arguments)};d=function(g){c.onGlobalUp.apply(c,arguments);b(document).unbind("mousemove touchmove",a);return b(document).unbind("mouseup touchend",d)};return this.container.bind("mousedown touchstart",function(g){c.onMouseDown.apply(c,
arguments);b(document).bind("mousemove touchmove",a);return b(document).bind("mouseup touchend",d)})};a.prototype.initialPosition=function(){var a,d;a=this._getDimension(this.container,"width");this.offLabel.css({width:a-this.containerRadius-4});d=this.containerRadius-4;b.browser.msie&&7>b.browser.version&&(d-=3);this.rightSide=a-this._getDimension(this.handle,"width")-d;this.elem.is(":checked")?(this.handle.css({left:this.rightSide}),this.onLabel.css({width:this.rightSide+this.handleRadius+5}),this.offSpan.css({marginRight:-this.rightSide})):
(this.onLabel.css({width:9}),this.onSpan.css({marginLeft:-this.rightSide}));if(this.isDisabled())return this.container.addClass(this.disabledClass)};a.prototype.onGlobalMove=function(b){var d;if(!this.isDisabled()&&a.currentlyClicking){b.preventDefault();d=b.pageX||b.originalEvent.changedTouches[0].pageX;if(!a.dragging&&Math.abs(a.dragStartPosition-d)>this.dragThreshold)a.dragging=!0;return this.onDragMove(b,d)}};a.prototype.onGlobalUp=function(b){if(a.currentlyClicking)return b.preventDefault(),
this.onDragEnd(b,b.pageX||b.originalEvent.changedTouches[0].pageX),!1};a.defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:!1,resizeContainer:!0,disabledClass:"switchBtnDisabled",containerClass:"uiSwitchBtn",labelOnClass:"switchBtnLabelOn",labelOffClass:"switchBtnLabelOff",handleClass:"switchBtnHandle",handleCenterClass:"switchBtnHandleCenter",handleRightClass:"switchBtnHandleRight",dragThreshold:5,handleMargin:15,handleRadius:4,containerWidth:60,containerRadius:5,dataName:"iphoneStyle",
onChange:function(){}};return a}();b.iphoneStyle=this.iOSCheckbox=h;b.fn.iphoneStyle=function(){var a,e,d,c,g,f,k,i,l;a=1<=arguments.length?j.call(arguments,0):[];d=null!=(c=null!=(f=a[0])?f.dataName:void 0)?c:h.defaults.dataName;i=this.filter(":checkbox");for(f=0,k=i.length;f<k;f++)e=i[f],c=b(e).data(d),null!=c?(e=a[0],g=2<=a.length?j.call(a,1):[],null!=(l=c[e])&&l.apply(c,g)):new h(e,a[0]);return this};b.fn.iOSCheckbox=function(a){null==a&&(a={});return this.iphoneStyle(b.extend({},a,{resizeHandle:!1,
disabledClass:"switchBtnDisabled",containerClass:"uiSwitchBtn",labelOnClass:"switchBtnLabelOn",labelOffClass:"switchBtnLabelOff",handleClass:"switchBtnHandle",handleCenterClass:"switchBtnHandleCenter",handleRightClass:"switchBtnHandleRight",dragThreshold:5,handleMargin:15,handleRadius:4,containerWidth:60,containerRadius:5,dataName:"iOSCheckbox"}))}}.call(this)});